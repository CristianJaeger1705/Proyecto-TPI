{% extends "base.html" %}

{% block content %}

<h1 class="mb-3">Gestión de Usuarios</h1>

<a href="{% url 'crear_usuario' %}" class="btn btn-success mb-3">
    <i class="bi bi-person-plus"></i> Crear Usuario
</a>

<table class="table table-striped table-bordered">
    <thead class="table-dark">
        <tr>
            <th>ID</th>
            <th>Usuario</th>
            <th>Email</th>
            <th>Rol</th>
            <th>Activo</th>
            <th>Verificado</th>
            <th>Acciones</th>
        </tr>
    </thead>

    <tbody>
        {% for u in usuarios %}
        <tr>
           <tbody>
    {% for u in usuarios %}
    <tr>
       <td>{{ u.id }}</td>
    <td>{{ u.username }}</td>
    <td>{{ u.email }}</td>
    <td>{{ u.get_rol_display }}</td>
    <td>{{ u.is_active|yesno:"Sí,No" }}</td>

    <!-- Verificación con icono -->
    <td class="text-center">
        {% if u.verificado %}
            <i class="bi bi-patch-check-fill text-success" title="Verificado"></i>
        {% else %}
            <i class="bi bi-x-circle text-danger" title="No verificado"></i>
        {% endif %}
    </td>

    <!-- ACCIONES -->
    <td class="text-center">

        <!-- Editar -->
        <a href="{% url 'editar_usuario' u.id %}"
           class="btn btn-sm btn-warning" title="Editar">
            <i class="bi bi-pencil-square"></i>
        </a>

        <!-- Eliminar -->
        <a href="{% url 'eliminar_usuario' u.id %}"
           class="btn btn-sm btn-danger"
           onclick="return confirm('¿Eliminar usuario?')"
           title="Eliminar">
            <i class="bi bi-trash"></i>
        </a>

        <!-- Activar -->
        <a href="{% url 'activar_usuario' u.id %}"
           class="btn btn-sm btn-success" title="Activar">
            <i class="bi bi-toggle-on"></i>
        </a>

        <!-- Desactivar -->
        <a href="{% url 'desactivar_usuario' u.id %}"
           class="btn btn-sm btn-secondary" title="Desactivar">
            <i class="bi bi-toggle-off"></i>
        </a>

        <!-- Verificar o quitar verificación -->
        {% if u.verificado %}
            <a href="{% url 'quitar_verificacion_usuario' u.id %}"
               class="btn btn-sm btn-info" title="Quitar verificación">
                <i class="bi bi-patch-check-fill"></i>
            </a>
        {% else %}
            <a href="{% url 'verificar_usuario' u.id %}"
               class="btn btn-sm btn-primary" title="Verificar">
                <i class="bi bi-patch-check"></i>
            </a>
        {% endif %}

    </td>
    </tr>
    {% endfor %}
</tbody>

        </tr>
        {% endfor %}
    </tbody>

</table>

{% endblock %}
